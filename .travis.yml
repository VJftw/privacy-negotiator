language: generic
sudo: required
services:
  - docker
env:
  global:
    - secure: "O5+rAToQpze2lML31lCcpTOTSWIpTba+P6QPkMYLMt3qQeJIMZVRiYbFgs1I3lMgrpsIuJZ5luHhODUv3wJ3C2tUhllllmH/0EmvP+LcoBAKuz51PKfGSNkUcikLBSUis1ysHsjE7VdVilw+p7BoqfBV+7Y7u/tPUTojlKA0n3i2+UPxgiNO+4av7LeC0wVmndv24usJ/S/02dmteu9SYYrkQLkwIbDVqCZGPAp0C7jdMHlOaTgZfp4+/mBXgCF8+wyWppfWUNvNUjVXFbR9YKk5F7RlOKefLrCOzWNCX4eOFtlzct2WVQirdM761bD+lkGNYvGk9rNQh4i2K9etPRGdyF2ptKElDJ6Eb11NpcqHauAKJm3+d905mtVX7BeZXrtFP6CEVhQxqCzNkrzyvndONIYKt3mTuLb+dZ0v9uQBSpKRTLVZ4SVo7ZO8QhBSe7BP5S/l0eMaUnUgDgVxGRYC3QSFB1mFpZJCgpw5qUoBitQuUIJgAzLyYWlEfcJib8RDyrIFdE9LT4ooIARzu0KfOesoeh5byHJTmj0k4n7jMyyUWqCdJWvMp6o8E6zTcwkKQdKFxiZR7WHW3dLaCYnCs8t/vyFJTTDE69nxmaqhp5PHDsP9OmwVPDKCtib5nG/V0v4DeRXx6LZ5TcLohs69gWZgFI/FnpupfXtRHdY="
    - secure: "fCKeitToOZGfghqYm4adzVlJuWSzZgInUJftJr2BuCBOm3zzxFjqW8I1l26KCkvpwFNWgp9QKbw3QwSUm1C/IoQeqNnM/IhE/sgVKcwfd0Lqtk/bAT5OiH5EfbOwftsWtuv7qHkdIdWqV31A81c+Pg+fYYUGDGDz4f6eCO261WWcpMzbKest1f+0eDJj3c0vrhE9GA+nOJFgId4xETCLO8/BPwerWtHgyXGqPfVUEsKz1kV4tSanbru64CMzy/sHt0cOqXO7t0Mf20yE5r/9Ln0BHIKrffuo5pENf3ZY6hxmRtgBL+hMnk2o66SNXnIHzbab0kkzH8eGBoPZuJMF4yPoK78X0xhS1Ij6M2qP5tRluaoZVEAIgsHpZ/iut3ckhrywiYYCyaG6g4v1t06bjSyoyOJd44DGTDiCADWV+tWQTRIpJqpabum9+d5BFJADjbDOFQEkIJfhMY37VQ/b4eIn5c6BxFueUGUwK4BVSn5LsnryRI1cl8LF2KR5ELXlxhZL6rRmLVY3cqKA3j9S4NKSkXF3meeB3g67jznNjJKctDr7q8yrZnt+g0uVmGvHBQ2HeJsUdUsG0whj6Lcy1P6K0wKBQJD8/2FOQq+3mwkDAixVZNoicwPARUvkdtkAl5V/dhFmJVmm1lrCHr/7XC54eJxtfJ9z1yYbbEXgvF4="
    - secure: "lyEQpnHMSZ5l0uqBu22MGL8B9gQc0VkCgH7f0Xq4IsTSQVTbj+HsdtlZxqX8UjPKnrXVaqaO8mkZ+JIvQqePXBAUoZ45UcnJsJ7JZBNQkXTUoUWLvBRzSaaxL45YKiVlHrCDZ8wbUAXHfY5PX2rBYCTZeeULzLeV2iyWL4orXYeQWugovmtuZeLFP1v720kn42FGgRkjln5XTP/vg5xkouF9EOt4R4TkUIGZU0Uz67X8JGxeO3KXoy0qneDzorq3zQEp7ta2N+1lYUHlLRJqWrpPo9Iha73PzrQZMKaAHJIsG4WfAbyCy16wgauWbvE1oNfrjQlIkojI1tjQiIXdZxKVKo4GY/sjvJcW7QtivCqK2KBd2cS54CNeBCjndwmM1MnBjWhvW4wSwP+o4noMElHBO4B1kEPvhV4D6jmOplIxCa2Fv51N0U43wLunL72a7FvzwCfkNhVmYvcdYCGer7h7NKzAg0kJVmyDZ5VWYekwBtflra2+H10MoGSdJ5xBYjfZbM5US/ithErVItJIcs3Tqlia6oa5U7bbeI62Zf7ewkr65TK4LpRLksa0MrEljcuHv1ceETGOZvYpSFJ8lmFOKa4AamSXJHLlM7Cu7sKl+rmHPAZo1pHeTWKl7JhOPkpQaPIZZopaqoCwq63q7gG2NxSOGsBWvbtxgErmaEU="
    - secure: "PH8WSed12Y1xeOGs5CrV94l4m9if8/TNt6/WPME6Ic/wxO06xyqlvz8klF3gls/2wbrfaTxbpW/3WYSyU4x4nx6nWK5kuQhUcUcJqhl6P96libyo4Nl/91fV5eN1el/cc8lPw3WYptoA0f+u2StcIwjmC5RPdEyXtppK11KVKYdEPP85NHD6QDVqfhadSvpYAIx8xAQVbF6t4TuwlOOVhNPK5uVNeGydgd7sFAF2PgOorFPXqee1caJvNfehZCFdtcWQYr1Av5/d+b1eDZLQ+iBGwKDYHueHvXrVkub+TDu/3D2No1FCv2oD6IPWA0YkwXkMOWISftqo7smsXZ3aKKiTxBk9oDEoJA2/65DLgxkQrnANN52IOv8s05tzRUHhQdrksNwxmxo+Mi9fhr/DsAg+BsElTB7bo+FKAOMry7qEoNtK+qpMg5ixxU1jUaF49uj2ih6EkW0/ghVsMxho0pNoAIzYWzircSxxxTUFVj4EL4FDioUbLj1qDkTp07VyOBILatnzWLaF95c/gNdhjxmr3pLAXJlgzesN3WB9htq/r3k+4yTLgoz4B8ZEFNvrHeaqhY+fh8CRXyBOV0Z29ojI5fH6DPNN40pKQL7k2vGiWGG5I+g8LZopdA0f0nIn68s20m/4ub8wuZsj8SDrwyH7hS/kgjP+8+G2HW82REE="


jobs:
  include:
    - stage: test
      script: cd ${TRAVIS_BUILD_DIR}/backend && make test
    - stage: test
      script: cd ${TRAVIS_BUILD_DIR}/web_app && make test
    - stage: deploy
      script:
        - docker login --username ${DOCKER_USERNAME} --password ${DOCKER_PASSWORD}
        - make deploy-apply
